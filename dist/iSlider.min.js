!function(a,b){function c(a,b){this.sliding=!1,this.translating=!1,this.frameFlag=0,this.oViewport=d.getElement(a),this.oSlider=this.oViewport.children[0],this.sliderStyle=this.oSlider.style,this.settings={direction:"y",oppositeSlide:!1,lockTheOtherDirection:!1,startX:0,startY:0},d.extend(this.settings,b||{}),this.goWithTouchStart=this.goWithTouchMove=this.goWithTouchEnd=null,this.moveTo(this.settings.startX,this.settings.startY),this.direction=this.settings.direction,this.init()}var d,e,f,g=a.document,h=g.createElement("div"),i={},j={},k=["webkit","moz","ms","o"];Date.now=Date.now||function(){return(new Date).getTime()},a.Math.tween=function(){return{Quad:{easeIn:{bezier:"cubic-bezier(0.79, 0.02, 1, 1.02)",fn:function(a,b,c,d){return c*(a/=d)*a+b}},easeOut:{bezier:"cubic-bezier(0, 0, 0.3, 0.97)",fn:function(a,b,c,d){return-c*(a/=d)*(a-2)+b}}},Quart:{easeIn:{bezier:"cubic-bezier(1, 0.03, 1, 1)",fn:function(a,b,c,d){return c*(a/=d)*a*a*a+b}},easeOut:{bezier:"cubic-bezier(0, 0, 0, 1)",fn:function(a,b,c,d){return-c*((a=a/d-1)*a*a*a-1)+b}}}}}(),j={hz:1e3/60,fingerFreeTime:300,fingerTicSpace:10,coefficient:6e-4,boundaryMire:3,amendTime:400},e={FPS:a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame||a.msRequestAnimationFrame||function(b){a.setTimeout(b,j.hz)}},d={detectCssSupport:function(a){var b=!1,c=0,d=k.length,e=null;if(a&&(a=a.toLowerCase()),"string"==typeof this.getStyle(h,a))b=!0;else for(;d>c;c++)if(e=["-",k[c],"-",a].join(""),"string"==typeof this.getStyle(h,e)){b=!0;break}return b},setCompatibleProperty:function(a,b,c){for(var c="string"==typeof c?c:c.join(" "),d=0,e=k.length;e>d;d++)a.setProperty(["-",k[d],"-",b].join(""),c);a.setProperty(b,c)},getStyle:function(b,c){return a.getComputedStyle(b,null).getPropertyValue(c)},getTranslate:function(a){var b,c=d.getStyle(a,"transform"),e=0,f=k.length;if(!c)for(;f>e;e++){var c=d.getStyle(a,["-",k[e],"-","transform"].join(""));if(c)break}return b=c.split(", "),{x:parseInt(b[4]),y:parseInt(b[5])}},extend:function(a,b){if(b&&"object"==typeof b)for(var c in b)a[c]=b[c];return a},addEve:function(a,b,c,d){return a.addEventListener(b,c,!!d),this},removeEve:function(a,b,c,d){return a.removeEventListener(b,c,!!d),this},getElement:function(a){return"string"==typeof a?g.querySelector(a):a}},i.supportTouch="ontouchstart"in a,i.supportCssMove=d.detectCssSupport("transform")&&d.detectCssSupport("transition"),c.prototype={INFO:{VERSION:"v1.3.0",AUTHOR:"http://tonylee.pw"},contructor:c,init:function(){i.supportTouch&&(this.measureViewport(),this.register())},register:function(b){var c=b?d.removeEve:d.addEve;c(this.oViewport,"touchstart",this),c(a,"touchmove",this),c(a,"touchend",this),c(a,"touchcancel",this),c(this.oSlider,"webkitTransitionEnd",this),c(this.oSlider,"oTransitionEnd",this),c(this.oSlider,"MSTransitionEnd",this),c(this.oSlider,"transitionend",this),c(a,"resize",this),c(a,"orientationchange",this)},breakInit:function(){this.register(!0)},handleEvent:function(a){switch(a.type){case"touchstart":this.touchstart(a);break;case"touchmove":this.touchmove(a);break;case"touchend":case"touchcancel":this.touchend(a);break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this.transitionend(a);break;case"resize":case"orientationchange":this.resize(a)}},touchstart:function(a){if(this.preventDefault=!1,this.sliding=!0,i.supportCssMove){if(this.translating){var b=d.getTranslate(this.oSlider);this.translating=!1,this.moveTo(b.x,b.y)}this.setTransition()}else this.brake();var c=a.touches[0],e=Date.now(),f=c.pageX,g=c.pageY;this.latestTime=e,this.refX=this.curX,this.refY=this.curY,this.startX=f,this.startY=g,this.startCurX=this.curX,this.startCurY=this.curY,this.distX=0,this.distY=0,this.goWithTouchStart&&this.goWithTouchStart(this.curX,this.curY)},touchmove:function(a){var b,c,e,g,h,i,k,l,m,n,o;if(this.sliding!==!1){b=a.touches[0],c=Date.now(),e=b.pageX,g=b.pageY,this.distX=e-this.startX,this.distY=g-this.startY,this.settings.oppositeSlide&&!this.preventDefault&&(m=Math.abs(this.distX),n=Math.abs(this.distY),(m>n&&"x"===this.direction||n>m&&"y"===this.direction)&&(this.preventDefault=!0)),(!this.settings.oppositeSlide||this.preventDefault)&&a.preventDefault();var p=Math.abs(this.distX)<j.fingerTicSpace,q=Math.abs(this.distY)<j.fingerTicSpace;c-this.lastTime>j.fingerFreeTime&&p&&q||this.settings.lockTheOtherDirection&&(f||(f=p||"x"!==this.direction?q||"y"!==this.direction?null:"y":"x"),f!==this.direction)||(h=this.startCurX+this.distX,i=this.startCurY+this.distY,"x"===this.direction?(k=d.getStyle(this.oSlider,"width"),o=parseFloat(k)-this.portWidth,i=this.curY,h=this.evaluateBoundaryMire(h,0>o?0:o)):(l=d.getStyle(this.oSlider,"height"),o=parseFloat(l)-this.portHeight,h=this.curX,i=this.evaluateBoundaryMire(i,0>o?0:o)),this.moveTo(h,i),c-this.latestTime>j.fingerFreeTime&&(this.latestTime=c,this.refX=this.curX,this.refY=this.curY),this.goWithTouchMove&&this.goWithTouchMove(this.curX,this.curY))}},touchend:function(a){var b,c;if(this.sliding!==!1){if(this.sliding=!1,this.settings.lockTheOtherDirection){if(null!==f&&f!==this.direction)return;f=null}b=Date.now(),c=this.evaluateRightPos(),this.lastTime=b,!c.isWrongPos&&b-this.latestTime<j.fingerFreeTime?this.evaluateInertia(c.startPos,c.refPos,c.distPort,c.distFloor):this.clearInertia(),this.goWithTouchEnd&&this.goWithTouchEnd(this.curX,this.curY,this.inertia),this.simulateInertia(c.startPos,c.rightPos)}},transitionend:function(a){var b;a.target==this.oSlider&&this.translating&&(b=this.evaluateRightPos(),b.isWrongPos&&!this.nonInertia?this.translate(j.amendTime,Math.tween.Quad.easeOut.bezier,b.rightPos):this.translating=!1)},resize:function(){this.measureViewport(),this.updateRightPosition()},measureViewport:function(){this.portWidth=parseFloat(d.getStyle(this.oViewport,"width")),this.portHeight=parseFloat(d.getStyle(this.oViewport,"height"))},updateRightPosition:function(){var a=this.evaluateRightPos();this.simulateInertia(a.startPos,a.rightPos)},brake:function(){this.frameFlag++},"continue":function(){return++this.frameFlag},clearInertia:function(){this.inertia=null,this.period=null,this.curve=null},stopInertia:function(){this.clearInertia(),this.nonInertia=!0},resumeInertia:function(){this.nonInertia=!1},moveTo:function(a,b){i.supportCssMove?this.updateTranslate(a,b):(this.sliderStyle.top=b+"px",this.sliderStyle.left=a+"px"),this.curX=a,this.curY=b},animateTo:function(a,b,c,d){c=c||j.amendTime/2,d=d||Math.tween.Quad.easeIn,this.frame(this["continue"](),Date.now(),a,b,c,d)},evaluateBoundaryMire:function(a,b){var c=a;return a>0?c=a/j.boundaryMire:-b>a&&(c=-b+(a+b)/j.boundaryMire),c},evaluateRightPos:function(){var a,b,c,e,f,g,h,i=!0;return"x"===this.direction?(a=parseFloat(d.getStyle(this.oSlider,"width")),c=this.portWidth,e=a-c,f=this.curX,g=this.refX,0>e?(i=0!==this.curX,e=0,h=0):this.curX>0?h=0:this.curX<-e?h=-e:(i=!1,h=this.curX)):(b=parseFloat(d.getStyle(this.oSlider,"height")),c=this.portHeight,e=b-c,f=this.curY,g=this.refY,0>e?(i=0!==this.curY,e=0,h=0):this.curY>0?h=0:this.curY<-e?h=-e:(i=!1,h=this.curY)),{isWrongPos:i,distPort:c,distFloor:e,startPos:f,refPos:g,rightPos:h}},evaluateInertia:function(a,b,c,d){var e=a-b,f=this.lastTime-this.latestTime,g=Math.abs(e/f),h=0>e?-1:1,i=a+g*g/(2*j.coefficient)*h,k=g/j.coefficient,l=Math.tween.Quad.easeOut;i>0?(i=c/2.5*(g/8),e=Math.abs(a)+i,k=e/g):-d>i?(i=-d-c/2.5*(g/8),e=Math.abs(i-a),k=e/g):l=Math.tween.Quart.easeOut,this.inertia=i,this.period=k,this.curve=l},simulateInertia:function(a,b){var c,d,e,f,g;this.nonInertia||(c=this,d=this.inertia,e=this.period,f=this.curve,g=Date.now(),"number"==typeof d?(this.clearInertia(),this.frame(this["continue"](),g,a,d,e,f,function(){var a=c.evaluateRightPos(),b=Date.now();c.frame(c["continue"](),b,a.startPos,a.rightPos,j.amendTime,Math.tween.Quad.easeOut)})):this.frame(this["continue"](),g,a,b,j.amendTime,Math.tween.Quad.easeOut))},frame:function(b,c,d,f,g,h,j){var k,l,m,n;if(i.supportCssMove)return void(d!==f&&(this.translating=!0,this.translate(g,h,f)));if(this.frameFlag===b)return d===f?void(j&&j()):(k=this,l=Date.now(),m=l-c,m>g&&(m=g),n=Math.round(h.fn(m,d,f-d,g)),"x"===this.direction?this.moveTo(n,this.curY):this.moveTo(this.curX,n),m===g?(this.brake(),void(j&&j())):void e.FPS.call(a,function(){k.frame(b,c,d,f,g,h,j)}))},setTransition:function(a){var b=a||["all","0s",Math.tween.Quad.easeOut.bezier,"0s"];return d.setCompatibleProperty(this.sliderStyle,"transition",b),this},updateTranslate:function(a,b){var c=["translate(",a,"px, ",b,"px)"].join("");return d.setCompatibleProperty(this.sliderStyle,"transform",c),this},translate:function(a,b,c){var d={};a=a/1e3+"s",this.setTransition(["all",a,b.bezier,"0s"]),"x"===this.direction?(d.x=c,d.y=this.curY):(d.x=this.curX,d.y=c),this.updateTranslate(d.x,d.y),this.curX=d.x,this.curY=d.y}},a.ISlider===b&&(a.ISlider=c)}(window);